{"version":3,"sources":["main.js"],"names":["init","result","isInApp","data","fakeData","doms","getElementById","index","innerHTML","btns","document","forEach","onclick","weekData","normalBookList","bookList","length","console","window","book","cover","name","desc","checked","code","slice","log","totalList","checkEnvironment","bookLish","concat","time","titles","options","content","zIndex","querySelectorAll","btn","e","that","this","message","modalTitle","modalContent","modalNotice","ellaH5","alert","onConfirm","dataset","open","downloadLink","classList","contains","add","_checkEnvironment","lineHeight","width","test","navigator","userAgent","webkit","messageHandlers","showSharePop","background","borderRadius","WebView","color","mobileType","top","querySelector","style","display","id","backgroundColor","confirmText","confirmStyle","height","textAlign","margin","setTimeout","remove","documentElement","overflow","err"],"mappings":"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","file":"../main.min.js","sourcesContent":["(function () {\n\n  try {\n\n    // 检测设备类型\n    let { isInApp, mobileType } = checkEnvironment();\n    console.log(isInApp, mobileType);\n    // TODO: 模拟在APP中，上线之前去掉\n    isInApp = true;\n\n    // 项目配置.\n    let downloadLink = 'http://www.baidu.com';\n    let modalTitle = \"订阅成功\", modalContent = \"感谢喜欢这本书，绘本上线当天会通知您来看哦！\", modalNotice = \"\";\n    if (!isInApp) {\n      modalContent = \"下载咿啦看书APP查看完整绘本书单\";\n      modalNotice = \"新用户免费赠送绘本大礼包哦\";\n      document.querySelector('.weixin').style.display = 'block';\n      document.querySelector('.weixin').onclick = function () {\n        window.open(downloadLink);\n      }\n    }\n\n    // // 弹窗属性配置\n    ellaH5.options = {\n      id: 'AlertBox',\n      style: {\n        width: '5.23rem',\n        padding: '.17rem .48rem',\n        backgroundColor: '#ffffff',\n        borderRadius: '0.21rem'\n      },\n      maskStyle: {\n        zIndex: 1000,\n        backgroundColor: 'rgba(0,0,0,0.5)'\n      },\n      confirmText: \"好的\",\n      confirmStyle: {\n        display: 'block',\n        width: '1.56rem',\n        height: '.6rem',\n        background: '#5baaf3',\n        textAlign: 'center',\n        lineHeight: '.6rem',\n        borderRadius: '.32rem',\n        margin: '.3rem auto 0',\n        color: '#fff'\n      }\n    }\n\n    // 声明：创建页面方法\n    function createWeeks(totalList) {\n\n      let result = '';\n      let titles = [\n        `<span>放假啦~~让宝宝在假期开始时</span>\n      <span>放松身心，准备迎接美好的寒假生活</span>`,\n\n        `<span>马上就要过年啦~~我们又长大了一岁</span>\n      <span>多学些人文知识，在假期增长宝宝的眼界！</span>`,\n\n        `<span>过年啦~~大家春节快乐</span>\n      <span>带宝宝一起来了解中国传统的过年习俗吧</span>`,\n\n        `<span>假期接近尾声了，别难过</span>\n      <span>打开绘本，继续奇妙的梦幻之旅</span>`,\n\n        `<span>开学恐惧症？不怕</span>\n      <span>每天一部动画书，给你假期好心情</span>`\n      ]\n\n      totalList.forEach((weekData, index, totalList) => {\n\n        let top = '';\n        let content = '';\n        let { bookList } = weekData, normalBookList = bookList;\n\n        /**\n         * 区分最后一周\n         * 如果不是最后一周，则是top(1)+content(6)的结构\n         * 如果是最后一周，则是cotent(3)的结构\n         */\n        if (index !== totalList.length - 1) {\n          let book = bookList[0];\n          // 创建 推荐图书\n          top = `\n          <div class=\"top\">\n            <div class=\"book-cover\" style=\"background:#39b3f3 url(${book.cover}) center no-repeat;\">\n              <div class=\"hot\">推荐</div>\n            </div>\n            <div class=\"book-content\">\n              <div class=\"book-name\">《${book.name}》</div>\n              <div class=\"book-desc\">${book.desc}</div>\n              <div class=\"book-btn ${book.checked ? 'checked' : ''}\" data-code=\"${book.code}\"></div>\n            </div>\n          </div>\n        `;\n          normalBookList = normalBookList.slice(1);\n        }\n        console.log(index, totalList.length)\n\n        // 创建图书列表\n        normalBookList.forEach((book, index, bookLish) => {\n          content += `\n          <div class=\"book\" ${index === 3 ? 'style=\"clear:both\"' : ''}>\n            <div class=\"cover\" style=\"background:#39b3f3 url(${book.cover}) center no-repeat;\">\n              <div>\n                <div class=\"book-btn ${book.checked ? 'checked' : ''}\" data-code=\"${book.code}\"></div>\n              </div>\n            </div>\n            <div class=\"name\">${book.name}</div>\n          </div>\n        `;\n        })\n\n        // 生成weeks代码串\n        result += `\n        <div class=\"week week${index}\">\n            <div class=\"tag\"></div>\n            <div class=\"title\">\n              <span>${weekData.time}</span>\n              ${titles[index]}\n            </div>\n            ${top}\n            <img class=\"divide\" src=\"./images/divide.png\"/>\n            <div class=\"content\">\n              ${content}\n            </div>\n        </div>\n      `;\n      })\n\n      return result;\n    }\n\n    // 声明：设备类型检测\n    function checkEnvironment() {\n      let isInApp, mobileType;\n      if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {\n        if (!!window.webkit && !!window.webkit.messageHandlers && !!window.webkit.messageHandlers.showSharePop) {\n          isInApp = true;\n        }\n        mobileType = \"iPhone\";\n      } else if (/(Android)/i.test(navigator.userAgent)) {\n        if (!!window.WebView && !!window.WebView.showSharePop) {\n          isInApp = true;\n        }\n        mobileType = \"Android\";\n      } else {\n        isInApp = false;\n        mobileType = \"other\";\n      }\n\n      window.isInApp = isInApp;\n      window.mobileType = mobileType;\n      return {\n        isInApp: !!isInApp,\n        mobileType\n      }\n    }\n\n    // 声明调用：主函数\n    function init() {\n      // 调用：创建页面方法\n      let data = fakeData();\n      let doms = createWeeks(data);\n      document.getElementById('Weeks').innerHTML = doms;\n      // 绑定点击事件\n      let btns = document.querySelectorAll('.book-btn');\n      btns.forEach(btn => {\n        btn.onclick = function (e) {\n\n          let that = this;\n          let message = `\n          <div class=\"mail\"></div>\n          <div>\n            <div class=\"title\">${modalTitle}</div>\n            <div class=\"content\">${modalContent}</div>\n            <div class=\"notice\">${modalNotice}</div>\n          </div>\n        `;\n\n          ellaH5.alert(message, {\n            onConfirm: function () {\n              console.log(that.dataset.code);\n              if (isInApp) {\n                console.log('App 内回调方法')\n              } else {\n                window.open(downloadLink)\n              }\n              // 按钮状态\n              if (!that.classList.contains('checked')) {\n                that.classList.add('checked')\n              }\n            }\n          });\n\n        }\n      });\n    }\n    window.init = init;\n\n    // TODO: 模拟请求到数据之后的回掉\n    window.setTimeout(function () {\n      init();\n      document.getElementById('Loading').style.display = 'none';\n      document.getElementById('Loading').remove();\n      document.documentElement.style.height = null;\n      document.documentElement.style.overflow = null;\n    }, 1300);\n\n  } catch (err) {\n    alert(err);\n  }\n\n})()"]}